-- Populate the order table with the data from temp_t (calling from quarterly dump SQL)

DELIMITER $$
CREATE PROCEDURE order_p()
BEGIN
	INSERT INTO vehdb.order_t(
		ORDER_ID,
		CUSTOMER_ID,
		SHIPPER_ID,
		PRODUCT_ID,
		QUANTITY,
		VEHICLE_PRICE,
		ORDER_DATE,
		SHIP_DATE,
		DISCOUNT,
		SHIP_MODE,
		SHIPPING,
		CUSTOMER_FEEDBACK,
		QUARTER_NUMBER
    )
    SELECT DISTINCT
		ORDER_ID,
		CUSTOMER_ID,
		SHIPPER_ID,
		PRODUCT_ID,
		QUANTITY,
		VEHICLE_PRICE,
		ORDER_DATE,
		SHIP_DATE,
		DISCOUNT,
		SHIP_MODE,
		SHIPPING,
		CUSTOMER_FEEDBACK,
		QUARTER_NUMBER
	FROM vehdb.vehicle_t WHERE ORDER_ID NOT IN (SELECT DISTINCT ORDER_ID FROM vehdb.order_t);
END;