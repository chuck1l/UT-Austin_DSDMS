Enable APIS

gcloud services enable compute.googleapis.com
gcloud services enable dataproc.googleapis.com

Choose Region
REGION=us-central1

Cloud Router
gcloud compute routers create router-${REGION} \
  --project=${GOOGLE_CLOUD_PROJECT} \
  --region=${REGION} \
  --network=default

NAT Gateway
gcloud compute routers nats create nat-${REGION} \
  --router=router-${REGION} \
  --nat-all-subnet-ip-ranges \
  --region ${REGION} \
  --auto-allocate-nat-external-ips

Enable Google Private Access
gcloud compute networks subnets update default \
  --region=${REGION} \
  --enable-private-ip-google-access

Create Cluster
gcloud dataproc clusters create data-eng \
  --enable-component-gateway \
  --region ${REGION} \
  --subnet default \
  --no-address \
  --single-node \
  --master-machine-type n1-standard-4 \
  --master-boot-disk-size 100 \
  --image-version 2.0-debian10 \
  --optional-components JUPYTER \
  --project $GOOGLE_CLOUD_PROJECT \
  --async

Jupyter Interface
gcloud dataproc clusters describe data-eng --region ${REGION} | grep JupyterLab

To Get the Spark UI
ZONE=$(gcloud compute instances list --filter="name~data-eng" --format "value(zone)")
gcloud compute ssh data-eng-m --ssh-flag "-L 8080:localhost:42229" --zone $ZONE
sleep 1800

